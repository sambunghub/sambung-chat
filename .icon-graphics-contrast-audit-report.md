# Icon and Graphics Contrast Audit Report

**WCAG 1.4.11 Non-text Contrast Compliance**

**Date:** 2026-01-26
**Auditor:** Automated Icon & Graphics Contrast Analysis Tool
**Application:** SambungChat
**Color System:** OKLCH with shadcn-svelte components

---

## Executive Summary

This report provides a comprehensive analysis of icon and graphics contrast ratios across the SambungChat application for WCAG 1.4.11 (Non-text Contrast) compliance. The audit examined 22 critical icon/graphics color combinations across both light and dark themes.

### Key Findings

| Theme | Passing (≥3:1) | Low Margin (3-4.5:1) | Failing (< 3:1) |
| ----- | -------------- | -------------------- | --------------- |
| Light | 18/22 (82%)    | 1/22 (5%)            | 3/22 (14%)      |
| Dark  | 19/22 (86%)    | 0/22                 | 3/22 (14%)      |

**Overall Status:** ⚠️ **Requires Attention**

The application has excellent icon contrast overall, but requires fixes for:

- Focus indicators in dark mode - CRITICAL
- Chart colors (if/when used) - MODERATE (not currently implemented)

---

## WCAG 1.4.11 Non-text Contrast Requirements

### Contrast Ratio Thresholds for Icons and Graphics

| Content Type                   | AA Requirement | Notes                              |
| ------------------------------ | -------------- | ---------------------------------- |
| Icons and graphical objects    | 3.0:1          | Against adjacent color             |
| UI components and borders      | 3.0:1          | Visual indicators required         |
| Focus indicators               | 3.0:1          | Must be clearly visible            |
| Charts and data visualizations | 3.0:1          | Each data point against background |

**Important Distinctions:**

- Icons require 3:1 contrast (vs 4.5:1 for text)
- Disabled state (opacity-50) is exempt from contrast requirements
- Decorative icons that convey no information are exempt
- Essential graphical presentations may have exceptions

---

## Critical Issues (Priority 1)

### Issue IG-001: Focus Indicator Contrast - Dark Theme

**Severity:** CRITICAL
**WCAG Criterion:** 2.4.7 Focus Visible (Level AA) + 1.4.11 Non-text Contrast
**Components Affected:** All interactive elements in dark mode (buttons, inputs, links, icons)

#### Current State

| Color Pair                  | Contrast Ratio | Required | Status  |
| --------------------------- | -------------- | -------- | ------- |
| `ring` on `background`      | 2.36:1         | 3.0:1    | ❌ FAIL |
| `sidebar-ring` on `sidebar` | 2.13:1         | 3.0:1    | ❌ FAIL |

**Color Values:**

- `--ring`: oklch(0.45 0.02 58.071)
- `--sidebar-ring`: oklch(0.45 0.02 58.071)
- Background: oklch(0.147 0.004 49.25) (dark)

**Impact:**

- Keyboard users cannot see which element has focus in dark mode
- Screen reader users who also use sight cannot verify focus position
- Violates WCAG 2.4.7 "Focus Visible" requirement
- Violates WCAG 1.4.11 "Non-text Contrast" requirement

**Root Cause:**
The focus ring color (L=0.45) is too dark for the dark background (L=0.147). For dark backgrounds, we need a LIGHTER focus ring color to create sufficient contrast.

**Recommended Fix:**

```css
/* apps/web/src/app.css - Dark theme */
.dark {
  /* Current: oklch(0.45 0.02 58.071) - 2.36:1 */
  /* Fix: Use lighter color for dark background */
  --ring: oklch(0.65 0.02 58.071); /* ~5:1 contrast on dark */
  --sidebar-ring: oklch(0.65 0.02 58.071); /* ~4.5:1 contrast */
}
```

**Alternative Options:**

1. **Conservative:** oklch(0.60 0.02 58.071) - ~4:1 contrast
2. **Recommended:** oklch(0.65 0.02 58.071) - ~5:1 contrast
3. **High contrast:** oklch(0.70 0.02 58.071) - ~6:1 contrast

**Note:** This contradicts the fix applied in subtask 2.2. The previous fix (L=0.45) works for light theme but not dark theme. Dark themes require lighter focus indicators, not darker ones.

---

## Moderate Issues (Priority 2)

### Issue IG-002: Chart Colors - Light Theme

**Severity:** MODERATE
**WCAG Criterion:** 1.4.11 Non-text Contrast (Level AA)
**Components Affected:** Charts and data visualizations (not yet implemented)

#### Current State

| Color Pair                | Contrast Ratio | Required | Status  |
| ------------------------- | -------------- | -------- | ------- |
| `chart-1` on `background` | 2.89:1         | 3.0:1    | ❌ FAIL |
| `chart-2` on `background` | 3.36:1         | 3.0:1    | ⚠️ LOW  |
| `chart-4` on `background` | 1.48:1         | 3.0:1    | ❌ FAIL |
| `chart-5` on `background` | 1.81:1         | 3.0:1    | ❌ FAIL |

**Color Values:**

- `--chart-1`: oklch(0.646 0.222 41.116) (terra cotta)
- `--chart-2`: oklch(0.6 0.118 184.704) (teal)
- `--chart-4`: oklch(0.828 0.189 84.429) (yellow)
- `--chart-5`: oklch(0.769 0.188 70.08) (orange)

**Impact:**

- Chart data points may not be distinguishable from background
- Users with color vision deficiencies may not perceive chart data
- Violates WCAG 1.4.11 for non-text contrast

**Status:** ⚠️ **NOT CURRENTLY IMPLEMENTED**

- No charts or data visualizations found in the application
- Chart colors are defined in app.css but not used
- Fix can be deferred until charts are implemented

**Recommended Fix (when charts are implemented):**

```css
/* apps/web/src/app.css - Light theme */
:root {
  /* Current chart colors with issues */
  /* --chart-1: oklch(0.646 0.222 41.116); 2.89:1 - FAIL */
  /* Fix: Darken slightly */
  --chart-1: oklch(0.58 0.22 41.116); /* ~3.5:1 */

  /* --chart-2: oklch(0.6 0.118 184.704); 3.36:1 - LOW MARGIN */
  /* Fix: Darken for better margin */
  --chart-2: oklch(0.55 0.12 184.704); /* ~4:1 */

  /* --chart-4: oklch(0.828 0.189 84.429); 1.48:1 - FAIL (too light) */
  /* Fix: Significant darkening required */
  --chart-4: oklch(0.65 0.19 84.429); /* ~3.2:1 */

  /* --chart-5: oklch(0.769 0.188 70.08); 1.81:1 - FAIL (too light) */
  /* Fix: Significant darkening required */
  --chart-5: oklch(0.6 0.19 70.08); /* ~3.5:1 */
}
```

**Alternative Approach:**
Consider using chart colors with higher chroma (saturation) and lower lightness for better visibility on white backgrounds.

---

### Issue IG-003: Chart Color 1 - Dark Theme

**Severity:** MODERATE
**WCAG Criterion:** 1.4.11 Non-text Contrast (Level AA)

#### Current State

| Color Pair                | Contrast Ratio | Required | Status  |
| ------------------------- | -------------- | -------- | ------- |
| `chart-1` on `background` | 2.54:1         | 3.0:1    | ❌ FAIL |

**Color Values:**

- `--chart-1`: oklch(0.488 0.243 264.376) (purple)

**Impact:**

- Same as IG-002, affects chart visibility
- Only chart-1 fails in dark theme; charts 2-5 pass

**Recommended Fix (when charts are implemented):**

```css
/* apps/web/src/app.css - Dark theme */
.dark {
  /* Current: oklch(0.488 0.243 264.376) - 2.54:1 */
  /* Fix: Lighten for dark background */
  --chart-1: oklch(0.55 0.24 264.376); /* ~3.5:1 */
}
```

---

## Passing Combinations

### Icons (All Themes)

All standard icon color combinations pass the 3:1 requirement:

| Icon Type                  | Light Theme | Dark Theme | Status       |
| -------------------------- | ----------- | ---------- | ------------ |
| Body content icons         | 14.72:1     | 14.30:1    | ✅ EXCELLENT |
| Card content icons         | 14.72:1     | 12.93:1    | ✅ EXCELLENT |
| Sidebar icons              | 14.30:1     | 12.93:1    | ✅ EXCELLENT |
| Secondary/decorative icons | 5.56:1      | 6.40:1     | ✅ GOOD      |
| Primary button icons       | 12.93:1     | 11.40:1    | ✅ EXCELLENT |
| Primary colored icons      | 13.31:1     | 12.61:1    | ✅ EXCELLENT |
| Accent colored icons       | 13.31:1     | 14.30:1    | ✅ EXCELLENT |
| Delete/error icons         | 5.86:1      | 5.90:1     | ✅ GOOD      |
| Sidebar active state icons | 12.93:1     | 5.63:1     | ✅ GOOD      |
| Sidebar hover icons        | 12.55:1     | 11.49:1    | ✅ EXCELLENT |

### Focus Indicators (Light Theme)

| Focus Type         | Contrast | Status       |
| ------------------ | -------- | ------------ |
| Ring on background | 7.60:1   | ✅ EXCELLENT |
| Sidebar ring       | 7.38:1   | ✅ EXCELLENT |

**Note:** Light theme focus indicators were fixed in subtask 2.2 and are now excellent.

---

## Analysis: Why Dark Theme Focus Rings Fail

### The Problem

Dark theme accessibility requires a different approach than light theme:

**Light Theme (Working Well):**

- Background: oklch(1 0 0) = L=1.0 (white)
- Focus ring: oklch(0.4 0.02 56.259) = L=0.4 (dark)
- Contrast: ~7.6:1 ✅

**Dark Theme (Failing):**

- Background: oklch(0.147 0.004 49.25) = L=0.147 (very dark)
- Focus ring: oklch(0.45 0.02 58.071) = L=0.45 (medium-dark)
- Contrast: ~2.36:1 ❌

### Why It Happens

The fix applied in subtask 2.2 changed the focus ring from L=0.553 to L=0.45. This improved contrast in light mode (where backgrounds are light) but actually made it worse in dark mode.

**The Rule:**

- **Light backgrounds:** Use dark focus indicators (low L value)
- **Dark backgrounds:** Use light focus indicators (high L value)

The current fix (L=0.45) is darker than the background (L=0.147), but not dark enough to create sufficient contrast. For dark backgrounds, we need values closer to L=0.6-0.7.

---

## Testing Recommendations

### Manual Testing Required

1. **Focus Indicator Testing**
   - Enable dark mode
   - Tab through entire application
   - Verify focus is clearly visible on all elements
   - Test buttons, inputs, links, dropdowns
   - Test on different screen sizes

2. **Icon Visibility Testing**
   - Test in both light and dark themes
   - Verify all icons are clearly visible
   - Test with users with mild visual impairments
   - Test in various lighting conditions

### Automated Testing

1. **axe-core** - Will catch contrast issues on rendered elements
2. **Lighthouse** - Run accessibility audit in both themes
3. **WAVE browser extension** - Visual contrast checking
4. **Custom audit script** - `bun run scripts/icon-graphics-contrast-audit.ts`

---

## Implementation Plan

### Phase 1: Critical Fixes (30 minutes)

1. **Fix dark theme focus indicators**
   - Update `--ring` and `--sidebar-ring` in dark theme
   - Test with keyboard navigation
   - Verify in all components

2. **Verification**
   - Run automated audit
   - Manual keyboard testing
   - Visual inspection

### Phase 2: Chart Color Fixes (Deferred)

1. **Defer until charts are implemented**
   - Chart colors are defined but unused
   - Fix when adding chart/data visualization features
   - Ensure all chart colors meet 3:1 requirement

---

## Icon Color Usage Patterns

Based on code analysis, icons inherit colors from text classes:

### Common Icon Patterns

```svelte
<!-- Secondary/decorative icons -->
<Icon class="text-muted-foreground" />

<!-- Primary active icons -->
<Icon class="text-primary" />

<!-- Destructive icons (delete, error) -->
<Icon class="text-destructive" />

<!-- Button icons inherit button text color -->
<Button>
  <Icon />
  <!-- Inherits primary-foreground -->
</Button>

<!-- Dropdown menu icons (automatic) -->
<!-- Uses: [&_svg:not([class*='text-'])]:text-muted-foreground -->
```

### Component-Specific Icon Colors

| Component         | Icon Color Class      | Background        | Contrast (Light) | Contrast (Dark) |
| ----------------- | --------------------- | ----------------- | ---------------- | --------------- |
| Sidebar nav       | text-foreground       | sidebar           | 14.30:1 ✅       | 12.93:1 ✅      |
| Dropdown items    | text-muted-foreground | (transparent)     | 5.56:1 ✅        | 6.40:1 ✅       |
| Card icons        | text-muted-foreground | card (white)      | 5.56:1 ✅        | 5.79:1 ✅       |
| Button icons      | (inherited)           | button background | 12.93:1 ✅       | 11.40:1 ✅      |
| Empty state icons | text-muted-foreground | background        | 5.56:1 ✅        | 6.40:1 ✅       |

---

## Compliance Status

### Current Compliance Level

| Criterion                     | Status     | Notes                                          |
| ----------------------------- | ---------- | ---------------------------------------------- |
| WCAG 1.4.11 Non-text Contrast | ⚠️ PARTIAL | Icons pass, focus indicators fail in dark mode |
| WCAG 2.4.7 Focus Visible      | ⚠️ PARTIAL | Light theme passes, dark theme fails           |

### After Proposed Fixes

| Criterion                     | Status  | Notes                           |
| ----------------------------- | ------- | ------------------------------- |
| WCAG 1.4.11 Non-text Contrast | ✅ PASS | All icons and graphics meet 3:1 |
| WCAG 2.4.7 Focus Visible      | ✅ PASS | All focus indicators meet 3:1   |

---

## Conclusion

The SambungChat application has excellent icon contrast across both themes. All standard icons (body, sidebar, buttons, cards) far exceed the 3:1 requirement, most achieving 5:1 or higher.

**Critical Issue:**
Dark theme focus indicators fail the 3:1 requirement at 2.13:1-2.36:1. This must be fixed before production to ensure keyboard users can navigate effectively in dark mode.

**Recommendation:**
Fix the dark theme focus rings immediately (30-minute effort). Defer chart color fixes until charts are actually implemented in the application.

**Overall Assessment:**
With the dark theme focus ring fix applied, the application will fully comply with WCAG 1.4.11 Non-text Contrast requirements.

---

## Appendix A: WCAG 1.4.11 Explained

**WCAG 1.4.11 Non-text Contrast:**
"The visual presentation of the following have a contrast ratio of at least 3:1 against adjacent color(s):"

- User Interface Components
  - Visual information required to identify user interface components and states
  - Boundaries indicating component focus (e.g., focus rings)

**Graphical Objects**

- Parts of graphics required to understand the content
- Exceptions: When a particular presentation is essential to the information

**Key Points:**

- 3:1 minimum for icons and graphics (vs 4.5:1 for text)
- Applies to user interface components and states
- Focus indicators must have 3:1 contrast
- Disabled components are exempt
- Decorative graphics are exempt

---

## Appendix B: Icon Size and Contrast

**Important Note:**
Icon size does NOT affect contrast requirements. A 16px icon and a 64px icon both need 3:1 contrast.

However, larger icons are easier to see due to:

- Increased visual area
- More detail visible
- Better for users with low vision

**Best Practice:**
Use minimum 16x16px for touch targets, 24x24px or larger for better accessibility.

---

**Report Generated:** 2026-01-26
**Next Review:** After implementing dark theme focus ring fix
**Audit Tool:** Custom OKLCH icon/graphics contrast calculator with WCAG 1.4.11 compliance checks
