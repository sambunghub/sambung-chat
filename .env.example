# ════════════════════════════════════════════════════════════════════════════
# SambungChat Environment Configuration Example
# ════════════════════════════════════════════════════════════════════════════
#
# Copy this file to .env and fill in your actual values.
# DO NOT commit the .env file to version control.
#
# Required Steps:
# 1. Copy this file: cp .env.example .env
# 2. Fill in the required values below (marked with [REQUIRED])
# 3. Choose at least ONE AI provider and configure its API key
#
# Usage:
# - Local development: bun run dev
# - Docker development: docker-compose -f docker-compose.dev.yml up (or bun run docker:dev)
# - Docker production: docker-compose -f docker-compose.prod.yml up (or bun run docker:prod)
#
# ════════════════════════════════════════════════════════════════════════════

# ════════════════════════════════════════════════════════════════════════════
# CORE APPLICATION SETTINGS
# ════════════════════════════════════════════════════════════════════════════

# Node environment (development, production, or test)
NODE_ENV=development

# Server port (for local development)
SERVER_PORT=3000

# Web port (for local development)
WEB_PORT=5174

# Public Server URL (used by Better Auth client on frontend)
# This should point to the frontend URL where the user is
PUBLIC_SERVER_URL=http://localhost:5174

# Public API URL (backend API URL - used for fetch calls from frontend)
PUBLIC_API_URL=http://localhost:3000

# ════════════════════════════════════════════════════════════════════════════
# ENCRYPTION KEY [REQUIRED]
# ════════════════════════════════════════════════════════════════════════════

# Master encryption key for encrypting sensitive data (API keys, etc.) [REQUIRED]
# Must be at least 32 characters long
# Used to encrypt API keys in the database using AES-256-GCM
# Generate with: openssl rand -base64 32
# ⚠️  Keep this key secure! If you lose this key, all encrypted data becomes unrecoverable
ENCRYPTION_KEY=your-encryption-key-at-least-32-characters-long

# ════════════════════════════════════════════════════════════════════════════
# DATABASE CONFIGURATION
# ════════════════════════════════════════════════════════════════════════════

# PostgreSQL database connection string [REQUIRED]
# Format: postgresql://user:password@host:port/database
#
# Local development (from host machine): use localhost
#   DATABASE_URL=postgresql://postgres:password@localhost:5432/sambungchat_dev
#
# Docker Compose: docker-compose overrides this to use 'postgres' service name
#   DATABASE_URL=postgresql://postgres:password@postgres:5432/sambungchat_dev
DATABASE_URL=postgresql://postgres:password@localhost:5432/sambungchat_dev

# PostgreSQL Configuration (used by docker-compose files)
# These are used by Docker containers for PostgreSQL setup
POSTGRES_USER=postgres
POSTGRES_PASSWORD=password
POSTGRES_DB=sambungchat_dev

# PostgreSQL port (only if running PostgreSQL separately from Docker)
# Default: 5432
# POSTGRES_PORT=5432

# ════════════════════════════════════════════════════════════════════════════
# AUTHENTICATION CONFIGURATION
# ════════════════════════════════════════════════════════════════════════════

# Better-Auth secret key [REQUIRED]
# Must be at least 32 characters long
# Generate a secure secret: openssl rand -base64 32
BETTER_AUTH_SECRET=your-better-auth-secret-at-least-32-characters-long

# Better-Auth URL [REQUIRED]
# The URL where your backend server is running (for OAuth callbacks)
# OAuth flow: Keycloak -> Backend (3000) -> Frontend (5173)
# Local development: http://localhost:3000
# Docker dev: http://localhost:3000
# Production: https://your-domain.com
BETTER_AUTH_URL=http://localhost:3000

# Email/password authentication flag (shared between frontend and backend)
# Set to "false" to disable email/password login (e.g., when using SSO only)
EMAIL_PASSWORD_ENABLED=true
PUBLIC_EMAIL_PASSWORD_ENABLED=true

# ════════════════════════════════════════════════════════════════════════════
# CORS CONFIGURATION
# ════════════════════════════════════════════════════════════════════════════

# CORS origin [REQUIRED]
# The frontend URL that's allowed to make API requests
# Local development: http://localhost:5174
# Production: https://your-domain.com
CORS_ORIGIN=http://localhost:5174

# ════════════════════════════════════════════════════════════════════════════
# KEYCLOAK OIDC CONFIGURATION (OPTIONAL)
# ════════════════════════════════════════════════════════════════════════════

# Enable Keycloak SSO on the frontend (shows "Sign in with SSO" button)
# Set to "true" when Keycloak is configured on the server
PUBLIC_KEYCLOAK_ENABLED=false

# Keycloak base URL
# Format: https://your-keycloak-domain
# Example: https://keycloak.example.com
# KEYCLOAK_URL=https://keycloak.example.com

# Keycloak realm name
# Example: myrealm
# KEYCLOAK_REALM=myrealm

# Keycloak client ID for OIDC authentication
# Create a client in your Keycloak realm to get this value
# KEYCLOAK_CLIENT_ID=your-keycloak-client-id

# Keycloak client secret for OIDC authentication
# Create a confidential client in Keycloak to get this value
# KEYCLOAK_CLIENT_SECRET=your-keycloak-client-secret

# Keycloak issuer URL (optional, will be constructed from KEYCLOAK_URL and KEYCLOAK_REALM if not provided)
# Format: https://your-keycloak-domain/realms/your-realm
# Example: https://keycloak.example.com/realms/myrealm
# KEYCLOAK_ISSUER=https://keycloak.example.com/realms/myrealm

# Note: At minimum, KEYCLOAK_URL, KEYCLOAK_REALM, KEYCLOAK_CLIENT_ID, and KEYCLOAK_CLIENT_SECRET must be set

# ════════════════════════════════════════════════════════════════════════════
# AI PROVIDER CONFIGURATION
# ════════════════════════════════════════════════════════════════════════════
#
# ⚠️  IMPORTANT: AI providers are now configured via the web UI, NOT environment variables
#
# After logging in, go to Settings → Models to configure your AI providers.
# You can add multiple models from different providers (OpenAI, Anthropic, Google, Groq, Ollama, OpenRouter, etc.)
# Each model requires an API key which is stored securely in the database (encrypted with AES-256-GCM).
#
# Supported providers:
#   - OpenAI (https://platform.openai.com/api-keys)
#   - Anthropic (https://console.anthropic.com/)
#   - Google AI (https://aistudio.google.com/app/apikey)
#   - Groq (https://console.groq.com/keys)
#   - Ollama (local, no API key needed)
#   - OpenRouter (https://openrouter.ai/keys)
#   - Custom OpenAI-compatible endpoints
#
# Quick Start:
# 1. Start the application: bun run dev
# 2. Open http://localhost:5174 in your browser
# 3. Login or register
# 4. Go to Settings → API Keys to add your provider API keys
# 5. Go to Settings → Models to create and configure AI models
# 6. Set a model as "Active" to use it for chat
#
# ════════════════════════════════════════════════════════════════════════════

# ════════════════════════════════════════════════════════════════════════════
# DOCKER DEVELOPMENT
# ════════════════════════════════════════════════════════════════════════════
#
# Quick Start with Docker:
#
# 1. Install dependencies locally (required for volume mounting):
#    bun install
#
# 2. Copy and configure environment:
#    cp .env.example .env
#    # Edit .env with your values
#
# 3. Start all services in Docker:
#    bun run docker:dev
#
# Services will be available at:
#   - Web App: http://localhost:5173
#   - API Server: http://localhost:3000
#   - PostgreSQL: localhost:5432
#
# Docker Commands:
#   bun run docker:dev          # Start all services
#   bun run docker:dev:build    # Rebuild and start
#   bun run docker:dev:logs     # View logs
#   bun run docker:dev:down     # Stop all services
#   bun run docker:prod         # Production mode
#
# ════════════════════════════════════════════════════════════════════════════
# SETUP INSTRUCTIONS
# ════════════════════════════════════════════════════════════════════════════

# 1. Copy this file to .env:
#    cp .env.example .env
#
# 2. Generate and fill in the required values:
#    - DATABASE_URL: Your PostgreSQL connection string
#    - BETTER_AUTH_SECRET: Generate a secure secret (min 32 chars): openssl rand -base64 32
#    - BETTER_AUTH_URL: Your application URL
#    - CORS_ORIGIN: Your frontend URL
#    - ENCRYPTION_KEY: Generate encryption key: openssl rand -base64 32
#
# 3. Start the application:
#    - Local development: bun run dev
#    - Docker development: bun run docker:dev
#    - Docker production: bun run docker:prod
#
# 4. Configure AI providers via web UI:
#    - Open http://localhost:5174 in your browser
#    - Login or register an account
#    - Go to Settings → API Keys to add your provider API keys
#    - Go to Settings → Models to create and configure AI models
#    - Set a model as "Active" to use it for chat
#
# ════════════════════════════════════════════════════════════════════════════
# SECURITY NOTES
# ════════════════════════════════════════════════════════════════════════════

# ⚠️  NEVER commit your .env file to version control
# ⚠️  NEVER share your API keys or secrets
# ⚠️  Use different API keys for development and production
# ⚠️  Rotate your API keys regularly
# ⚠️  Keep your BETTER_AUTH_SECRET secure and unpredictable
#
# ════════════════════════════════════════════════════════════════════════════
